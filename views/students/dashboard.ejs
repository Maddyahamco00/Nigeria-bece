<!-- views/students/dashboard.ejs -->

<div class="student-dashboard">
  <div class="dashboard-hero">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-md-8">
          <h1 class="hero-title">
            <i class="fas fa-user-graduate me-3"></i>
            Welcome, <%= student.name %>!
          </h1>
          <p class="hero-subtitle">Your BECE journey dashboard - track your progress and access your results</p>
        </div>
        <div class="col-md-4 text-end">
          <div class="student-avatar">
            <i class="fas fa-user-circle fa-5x"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="container mt-4">
    <div class="row">
      <div class="col-md-3">
        <div class="student-sidebar">
          <h5 class="sidebar-title">Navigation</h5>
          <ul class="nav flex-column">
            <li class="nav-item"><a href="/students/dashboard" class="nav-link active"><i class="fas fa-tachometer-alt me-2"></i> Overview</a></li>
            <li class="nav-item"><a href="/students/profile" class="nav-link"><i class="fas fa-user me-2"></i> Profile</a></li>
            <li class="nav-item"><a href="/students/results" class="nav-link"><i class="fas fa-chart-bar me-2"></i> Results</a></li>
            <% if (results && results.length > 0) { %>
            <li class="nav-item"><a href="/students/certificate" class="nav-link"><i class="fas fa-certificate me-2"></i> Certificate</a></li>
            <% } %>
            <li class="nav-item"><a href="/payment" class="nav-link"><i class="fas fa-credit-card me-2"></i> Payments</a></li>
            <li class="nav-item"><a href="/auth/logout" class="nav-link text-danger"><i class="fas fa-sign-out-alt me-2"></i> Logout</a></li>
          </ul>
        </div>
      </div>
      <div class="col-md-9">

        <div class="row">
          <div class="col-md-6">
            <div class="info-card">
              <div class="card-icon">
                <i class="fas fa-id-card"></i>
              </div>
              <div class="card-content">
                <h5>Registration Information</h5>
                <div class="info-grid">
                  <div class="info-item">
                    <span class="info-label">Student Code</span>
                    <span class="info-value student-code"><%= student.studentCode || student.regNumber %></span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">School</span>
                    <span class="info-value"><%= student.School ? student.School.name : 'N/A' %></span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">State</span>
                    <span class="info-value"><%= student.State ? student.State.name : 'N/A' %></span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">LGA</span>
                    <span class="info-value"><%= student.LGA ? student.LGA.name : 'N/A' %></span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-6">
            <div class="payment-card">
              <div class="card-icon">
                <i class="fas fa-credit-card"></i>
              </div>
              <div class="card-content">
                <h5>Payment Status</h5>
                <% if (student.paymentStatus && student.paymentStatus.toLowerCase() === 'paid') { %>
                  <div class="payment-status paid">
                    <i class="fas fa-check-circle me-2"></i>
                    Payment Completed
                  </div>
                  <p class="payment-note">Your registration is fully processed</p>
                <% } else { %>
                  <div class="payment-status pending">
                    <i class="fas fa-clock me-2"></i>
                    Payment Pending
                  </div>
                  <p class="payment-note">Complete your payment to finalize registration</p>
                  <a href="/payment" class="action-btn warning">
                    <i class="fas fa-credit-card me-2"></i>
                    Make Payment Now
                  </a>
                <% } %>
              </div>
            </div>
          </div>
        </div>

        
        <div class="row mt-4">
          <div class="col-12">
            <div class="results-card">
              <div class="card-icon">
                <i class="fas fa-chart-bar"></i>
              </div>
              <div class="card-content">
                <h5>Examination Results</h5>
                <% if (results && results.length > 0) { %>
                  <div class="results-table">
                    <div class="table-header">
                      <div class="header-item">Subject</div>
                      <div class="header-item">Score</div>
                      <div class="header-item">Grade</div>
                      <div class="header-item">Remark</div>
                    </div>
                    <% results.forEach(r => { %>
                      <div class="table-row">
                        <div class="row-item subject"><%= r.subject %></div>
                        <div class="row-item score"><%= r.score %></div>
                        <div class="row-item grade">
                          <% if (r.score >= 70) { %>
                            <span class="grade-badge excellent">A</span>
                          <% } else if (r.score >= 60) { %>
                            <span class="grade-badge good">B</span>
                          <% } else if (r.score >= 50) { %>
                            <span class="grade-badge average">C</span>
                          <% } else if (r.score >= 40) { %>
                            <span class="grade-badge pass">D</span>
                          <% } else { %>
                            <span class="grade-badge fail">F</span>
                          <% } %>
                        </div>
                        <div class="row-item remark">
                          <% if (r.score >= 70) { %>
                            Excellent
                          <% } else if (r.score >= 60) { %>
                            Very Good
                          <% } else if (r.score >= 50) { %>
                            Good
                          <% } else if (r.score >= 40) { %>
                            Pass
                          <% } else { %>
                            Fail
                          <% } %>
                        </div>
                      </div>
                    <% }) %>
                  </div>
                  <div class="results-actions">
                    <a href="/students/results" class="action-btn primary">
                      <i class="fas fa-eye me-2"></i>
                      View Full Results
                    </a>
                    <a href="/students/certificate" class="action-btn success">
                      <i class="fas fa-certificate me-2"></i>
                      Download Certificate
                    </a>
                  </div>
                <% } else { %>
                  <div class="no-results">
                    <i class="fas fa-hourglass-half fa-3x mb-3"></i>
                    <h6>Results Not Available</h6>
                    <p>Your BECE results have not been published yet. Please check back later.</p>
                  </div>
                <% } %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
